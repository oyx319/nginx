server {
        listen 80;
        server_name rls.kp-para.cn;
        access_log  /var/log/nginx/access/access-rls-kp.log access;
	proxy_http_version 1.1;
        if ($request_method !~* GET|POST|DELETE|PUT|OPTIONS) {
            return 403;
        }

        location ^~ /board/ {
                proxy_pass http://58.251.134.117:31187/board/;
                include proxy_params;
        }
        location ^~ /public/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location = /MP_verify_YxeE4eygQI93CAXc.txt {
                root /usr/share/nginx/html;
                index MP_verify_YxeE4eygQI93CAXc.txt;
        }

        location / {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
}
server{
	listen 80;
	server_name apicdn-rls.kp-para.cn;
        access_log  /var/log/nginx/access/access-apicdn-kp.log access;
	client_max_body_size 200m;
	proxy_http_version 1.1;
        location ^~ /core/ {
        proxy_pass http://58.251.134.117:31187;
        }
	
}
server{
        listen 80;

        server_name api-rls.kp-para.cn;
        access_log  /var/log/nginx/access/access_apirls_kp.log access;
        client_max_body_size 200m;
        proxy_http_version 1.1;
        if ($request_method !~* GET|POST|DELETE|PUT|OPTIONS) {
            return 403;
        }

        location ^~ /es/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /git-server/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /core/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /lesson/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /lessonapi/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /marshal/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /sensi/ {
               # proxy_pass http://10.28.18.25:7001/;
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /gosys/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /accounting/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /kpdataware/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /event-gateway/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /ts-storage/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /push-manage/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /online-quiz/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /push-server/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
               # proxy_pass http://10.28.18.25:8001;
        }
        location ^~ /delay-service/ {
                #add_header Access-Control-Allow-Origin *;
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /hook-center/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /ggs-manager/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /version-control/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /nginx/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /edu/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /lesson-center/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
        location ^~ /client-marketing/ {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }


}
server{
        listen 80;
        server_name dashboard-rls.kp-para.cn;
        access_log /var/log/nginx/access/access-kw-dashboard-rls.log access;
	proxy_http_version 1.1;
        location / {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
}
server{
        listen 80;
        server_name edu-rls.kp-para.cn;
        access_log /var/log/nginx/access/edu-rls.log access;
        proxy_http_version 1.1;
        location / {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
}
server{
        listen 80;
        server_name dashboard2-rls.kp-para.cn;
        access_log /var/log/nginx/access/dashboard2-rls.log access;
        proxy_http_version 1.1;
        location / {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
}
server{
        listen 80;
        listen 443;
        server_name haqi-rls.kp-para.cn;
        access_log /var/log/nginx/access/haqi-rls.log access;
        proxy_http_version 1.1;

        ssl on;
        ssl_certificate /etc/nginx/ssl/haqi-rls.kp-para.cn_nginx/haqi-rls.kp-para.cn_bundle.crt;
        ssl_certificate_key /etc/nginx/ssl/haqi-rls.kp-para.cn_nginx/haqi-rls.kp-para.cn.key;

        location / {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
}

server{
        listen 80;
        server_name macros-rls.kp-para.cn;
        access_log /var/log/nginx/access/macros-rls.log access;
        proxy_http_version 1.1;

        location / {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
}


# blackboard
server{
        listen 80;
        server_name blackboard-rls.kp-para.cn;
        access_log /var/log/nginx/access/access-kw-blackboard-rls.log access;
        proxy_http_version 1.1;
        location / {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Credentials' 'true';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,web-token,app-token,Authorization,Accept,Origin,Keep-Alive,User-Agent,X-Mx-ReqToken,X-Data-Type,X-Auth-Token,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
                if ($request_method = 'OPTIONS') {
                  add_header 'Access-Control-Max-Age' 1728000;
                  add_header 'Content-Type' 'text/plain; charset=utf-8';
                  add_header 'Content-Length' 0;
                  return 204;
                 }
        }
}
server{
        listen 80;
        server_name accounting-dashboard-rls.kp-para.cn;
        access_log /var/log/nginx/access/access-accounting-db-rls.log access;
        proxy_http_version 1.1;
        location / {
                proxy_pass http://accounting-dashboard-release.kp-para.cn:31187;
        }
}
server{
        listen 80;
        server_name sales-dashboard-rls.kp-para.cn;
        access_log /var/log/nginx/access/access-sales-rls.log access;
	proxy_http_version 1.1;
        location / {
                proxy_pass http://paracraft-sales-rls1.kp-para.cn:31187;
        }
}
server{
        listen 80;
        server_name customer-dashboard-rls.kp-para.cn;
        access_log /var/log/nginx/access/access-customer-rls.log access;
	proxy_http_version 1.1;
        location / {
                proxy_pass http://customer-dashboard-release.kp-para.cn:31187;
                #proxy_pass http://58.251.134.117:31187;
                proxy_http_version 1.1;
        }
}

# push-server 

upstream push_server_backend{
	server 58.251.134.117:31015 weight=10;
}

server{
        listen 80;
        server_name socket-rls.kp-para.cn;
        access_log /var/log/nginx/access/access-socket-rls.log access;
        # include /etc/nginx/keepwork_ssl;
        proxy_http_version 1.1;
        location ^~ / {
                include proxy_params;
                proxy_set_header Upgrade $http_upgrade;
                proxy_set_header Connection "upgrade";
                 proxy_http_version 1.1;
                 proxy_set_header Connection "";
                 proxy_pass http://push_server_backend;
                 #proxy_pass http://api-rls.kp-para.cn/push-server/;
        }
}
server{
        listen 80;

        server_name client-rls.kp-para.cn;
        access_log /var/log/nginx/access/a-client-dev.log access;
        proxy_http_version 1.1;
        location = /MP_verify_NShWUEnPPMuxAuDf.txt {
                 root /usr/share/nginx/html;
                 index  MP_verify_NShWUEnPPMuxAuDf.txt;
        }

        location / {
                proxy_pass http://58.251.134.117:31187;
                include proxy_params;
        }
}
